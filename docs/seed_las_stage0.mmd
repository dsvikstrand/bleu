%% Stage 0 LAS (Linear Agentic Seeding) runner visualization
%% Source of truth: codex/skills/seed-blueprints/scripts/seed_stage0.ts

flowchart TD
  A[Seed Spec<br/>seed/seed_spec_v0.json] --> B[seed_stage0.ts<br/>parse args + validate spec]
  B --> C[Create run folder<br/>seed/outputs/RUN_ID/]
  C --> D{no backend?}

  D -- Yes --> E[Skip backend calls<br/>(offline mode)]
  E --> F[Write run_log.json<br/>config.backendCalls=false]
  F --> Z[Done (artifacts only)]

  D -- No --> G[Read SEED_USER_ACCESS_TOKEN<br/>(Supabase access_token)]
  G --> H[Node n1: generate_library<br/>POST bapi /api/generate-inventory<br/>body: { keywords: library.topic }]
  H --> H1[Write library.json<br/>{summary, categories (array)}]

  H1 --> I[Node n2: generate_blueprints<br/>For each blueprint variant in spec:<br/>POST bapi /api/generate-blueprint<br/>body: { title, description, notes, tags, library }]
  I --> I1[Write blueprints.json<br/>{title, steps (array)} (array)]

  I1 --> J[Node n3: generate_review_requests<br/>(No network)<br/>Prepare payloads for /api/analyze-blueprint]
  J --> J1[Write review_requests.json]

  J1 --> K[Node n4: generate_banner_requests<br/>(No network)<br/>Prepare payloads for /api/generate-banner]
  K --> K1[Write banner_requests.json]

  K1 --> L[Node n5: validate<br/>Check every (category,item) referenced exists in library]
  L --> L1[Write validation.json<br/>ok/errors/warnings/stats]

  L1 --> M[Node n6: publish_payload<br/>(No writes)<br/>Assemble 'would publish' blueprint payload]
  M --> M1[Write publish_payload.json]

  M1 --> N[Append run_log.json<br/>step timings + status]
  N --> Z[Done (artifacts only)]
